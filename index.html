<!doctype html>
<html lang="ko">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Vol. 18 ë‘ê»˜ ê³„ì‚°</title>
<style>
  :root{--panel-max:90vh}
  html,body{height:100%}
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;line-height:1.45;max-width:1100px;margin:24px auto;padding:0 16px}
  h1{font-size:1.6rem;margin:0 0 10px;display:flex;align-items:center;justify-content:space-between}
  .grid{display:grid;gap:16px}
  .grid-2{grid-template-columns:1fr 1fr; column-gap:24px}
  @media (max-width:740px){.grid-2{grid-template-columns:1fr}}
  .card{border:1px solid #ddd;border-radius:14px;padding:16px;box-shadow:0 2px 8px rgba(0,0,0,.05);margin:10px 0;background:#fff}
  label{display:block;font-weight:600;margin:.4rem 0 .3rem}
  input,select,button,textarea{font-size:1rem}
  input,select{width:100%;padding:.7rem .8rem;border:1px solid #ccc;border-radius:10px;box-sizing:border-box}
  .btn{padding:.6rem 1rem;border-radius:10px;border:1px solid #ccc;background:#fff;cursor:pointer}
  .btn.primary{background:#111;color:#fff;border-color:#111}
  .btn.small{padding:.3rem .6rem;font-size:.9rem}
  .out{background:#fafafa;border:1px dashed #ddd;border-radius:10px;padding:12px;margin-top:8px}
  table{width:100%;border-collapse:collapse;margin-top:8px;table-layout:fixed}
  th,td{border:1px solid #e4e4e4;padding:8px;text-align:center;word-break:keep-all}
  th{background:#f6f6f6}
  .pill{display:inline-block;padding:2px 8px;border-radius:999px;font-weight:700}
  .ok{background:#e7f7ee;color:#0a7f55}
  .warn{background:#fff7e6;color:#b06900;border:1px solid #ffe1a7}
  .no{background:#fdeceb;color:#b42318}
  .muted{color:#666;font-size:.92rem}
  .small{font-size:.9rem}
  .big{font-size:1.6rem;font-weight:800}
  .toggle{cursor:pointer;user-select:none;display:flex;align-items:center;gap:8px}
  .caret{transition:transform .2s ease}
  .collapsed .caret{transform:rotate(-90deg)}
  .hidden{display:none}
  .details{margin-top:8px}
  .details code{background:#f3f3f3;border-radius:6px;padding:2px 6px}
  .catwrap{display:grid;grid-template-columns:repeat(4,1fr); gap:10px; margin-top:8px}
  @media (max-width:740px){.catwrap{grid-template-columns:repeat(2,1fr)}}
  .catbtn{height:42px; display:flex; align-items:center; justify-content:center;
          border-radius:10px; border:1px solid #ddd; background:#fff; cursor:pointer; font-weight:700;}
  .catbtn.active{background:#111;color:#fff;border-color:#111}
  .adminbar{display:none} /* header buttons ìˆ¨ê¹€(ë¬¸ì„œ í•˜ë‹¨ì— ë™ì¼ ë²„íŠ¼ ë°°ì¹˜) */

  /* Modal & panel scroll */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;padding:16px;overflow:auto}
  .modal.show{display:flex}
  .panel{background:#fff;border-radius:14px;box-shadow:0 10px 30px rgba(0,0,0,.2);width:min(980px,100%);max-height:var(--panel-max);overflow:auto;-webkit-overflow-scrolling:touch;padding:16px}
  .panel h3{margin:6px 0 10px}
  .tg{display:grid;grid-template-columns:2fr 1fr 1fr auto;gap:8px;align-items:center}
  .tg .hdr{font-weight:700;color:#444}
  .fg{display:grid;grid-template-columns:1.5fr 1.5fr .8fr auto;gap:8px;align-items:center}
  .lg{display:grid;grid-template-columns:2fr 1fr auto;gap:8px;align-items:center}
  .row{display:contents}
  .row>*{min-width:0}
  .delbtn{white-space:nowrap}

  /* collapsible */
  details summary{cursor:pointer;user-select:none;font-weight:700}
  details{border:1px dashed #e5e5e5;border-radius:10px;padding:10px;margin:8px 0}
</style>
<body>
  <h1>
    <span>Vol.18 ë‘ê»˜ ê³„ì‚°</span>
    <span class="adminbar">
      <button class="btn small" onclick="exportJSON()">JSON ë‚´ë³´ë‚´ê¸°</button>
      <button class="btn small" onclick="importJSON()">JSON ê°€ì ¸ì˜¤ê¸°</button>
      <button class="btn small" onclick="saveIntoHTML()">HTMLë¡œ ì €ì¥</button>
      <button class="btn primary small" onclick="openAdmin()">Admin</button>
    </span>
  </h1>

  <div class="card">
    <div class="grid grid-2">
      <div>
        <label>ë†’ì´ (mm)</label>
        <input id="height" type="number" step="0.001" value="1000" />
      </div>
      <div>
        <label>íŠœë¸Œ</label>
        <select id="tube"></select>
        <div class="small muted">íŠœë¸Œ ëª©ë¡ì€ ì•„ë˜ì—ì„œ í¼ì³ì„œ í™•ì¸ ê°€ëŠ¥</div>
      </div>
    </div>

    <div style="margin-top:10px">
      <label>ì›ë‹¨ ì¹´í…Œê³ ë¦¬</label>
      <div class="catwrap" id="catwrap"></div>
    </div>

    <div style="margin-top:8px">
      <label>ì›ë‹¨ ì¢…ë¥˜</label>
      <select id="fabric"></select>
    </div>

    <div class="out" style="margin-top:12px">
      <div>ì „ì²´ ë‘ê»˜ <span class="big" id="g6">-</span> mm</div>
      <div id="detailToggle" class="toggle collapsed" onclick="toggleDetails()">
        <span class="caret">â–¶</span><span class="muted small">ìƒì„¸ ë³´ê¸° (ì§€ë¦„Â·ê³µì‹Â·ì¤‘ê°„ê°’)</span>
      </div>
      <div id="details" class="details hidden small">
        <div>ì§€ë¦„ = <b id="diameter">-</b> mm, ì›ë‹¨ ë‘ê»˜/í”¼ì¹˜ = <b id="e6">-</b></div>
        <div>ê³µì‹: <code>I = ((-2Ï€Â·ì§€ë¦„) + âˆš((2Ï€Â·ì§€ë¦„)^2 + 8Ï€Â·ë†’ì´Â·ì›ë‹¨ë‘ê»˜)) / (2Ï€Â·ì›ë‹¨ë‘ê»˜)</code></div>
        <div>I = <b id="i6">-</b></div>
      </div>
    </div>
  </div>

  <div class="card">
    <h3>ì»¤ë²„ë³„ ìµœëŒ€ ë‘ê»˜ & ì ìš© ê°€ëŠ¥ ì—¬ë¶€</h3>
    <table id="limitTable">
      <thead><tr><th>ì»¤ë²„</th><th>ìµœëŒ€ ë‘ê»˜</th><th>ì ìš© ê°€ëŠ¥ ì—¬ë¶€</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <div class="card collapsed" id="tubeCard">
    <div class="toggle" onclick="toggleTubeList()">
      <span class="caret">â–¶</span><h3 style="margin:0">íŠœë¸Œ ëª©ë¡ (ì ‘ê¸°/í¼ì¹˜ê¸°)</h3>
    </div>
    <div id="tubeList" class="hidden">
      <table>
        <thead><tr><th>íŠœë¸Œ</th><th>íŠœë¸Œë¬´ê²Œ</th><th>ì§€ë¦„</th></tr></thead>
        <tbody id="tubeTable"></tbody>
      </table>
    </div>
  </div>

  <!-- ë‚´ì¥ ë°ì´í„°(JSON) -->
  <script id="data-json" type="application/json">
 {
  "groups": {
    "ì´ë…¸ìœˆ": [
      {"display":"Innocence 75mm","original":"â— ì´ë…¸ì„¼ìŠ¤ AT 75","e6":0.49},
      {"display":"Shangrila Solid","original":"2. ìƒ¹ê·¸ë¦´ë¼ ì†”ë¦¬ë“œ","e6":0.62},
      {"display":"Shangrila Blackout","original":"1. ìƒ¹ê·¸ë¦´ë¼ ì•”ë§‰","e6":0.76},
      {"display":"Innocence 75mm","original":"3. ì´ë…¸ì„¼ìŠ¤ 75","e6":0.49}
    ],
    "íŠ¸ìœˆìŠ¤": [
      {"display":"TWG Gold","original":"â— TWG GOLD","e6":0.35},
      {"display":"â— ë©”íƒˆ","original":"â— ë©”íƒˆ","e6":0.34},
      {"display":"â— ì•°ë²„","original":"â— ì•°ë²„","e6":0.27},
      {"display":"Sparkle","original":"4. ìŠ¤íŒŒí´","e6":0.46}
    ],
    "ì½¤ë¹„": [
      {"display":"Acaba2 (Semi Blackout)","original":"â— Acaba â…¡ ì•”ë§‰","e6":0.51},
      {"display":"Alpine","original":"â— Alpine","e6":0.29},
      {"display":"Belita","original":"â— Belita","e6":0.48},
      {"display":"Celestial","original":"â— Celestial","e6":0.32},
      {"display":"Evere (Semi Blackout)","original":"â— Evere ì•”ë§‰","e6":0.42},
      {"display":"Daisy (Semi Blackout)","original":"â— ë°ì´ì§€ ì•”ë§‰","e6":0.42},
      {"display":"â— ë¸ë¡œìŠ¤ ì•”ë§‰","original":"â— ë¸ë¡œìŠ¤ ì•”ë§‰","e6":0.49},
      {"display":"Lento (Semi Blackout)","original":"â— ë Œí†  ì•”ë§‰","e6":0.49},
      {"display":"â— ë£¨ì´ìŠ¤","original":"â— ë£¨ì´ìŠ¤","e6":0.35},
      {"display":"Linen B/O (Semi Blackout)","original":"â— ë¦°ë„¨ ì•”ë§‰","e6":0.69},
      {"display":"â— ëª°íƒ€","original":"â— ëª°íƒ€","e6":0.37},
      {"display":"Bailey","original":"â— ë² ì¼ë¦¬","e6":0.29},
      {"display":"â— ì•„ë¹„ìŠ¤","original":"â— ì•„ë¹„ìŠ¤","e6":0.26},
      {"display":"â— ì¹´ë°€ë¼ ì•”ë§‰ (ë°©ì—¼)","original":"â— ì¹´ë°€ë¼ ì•”ë§‰ (ë°©ì—¼)","e6":0.45},
      {"display":"Timberlook","original":"â— íŒ€ë²„ë£© ë·°","e6":0.45},
      {"display":"â— íŒŒë¥´ë§ˆ ì•”ë§‰","original":"â— íŒŒë¥´ë§ˆ ì•”ë§‰","e6":0.49},
      {"display":"Naomi (Semi Blackout)","original":"5. ë‚˜ì˜¤ë¯¸ ì•”ë§‰ (ë°©ì—¼/ë¹„ë°©ì—¼ íƒ)","e6":0.62},
      {"display":"Dublin","original":"19. ë”ë¸”ë¦°","e6":0.34},
      {"display":"Lafia (Semi Blackout)","original":"12. ë¼í”¼ì•„ ì•”ë§‰","e6":0.5},
      {"display":"â— ë¦¬ë””ì•„ ì•”ë§‰ (ë°©ì—¼/ë¹„ë°©ì—¼ íƒ)","original":"8. ë¦¬ë””ì•„ ì•”ë§‰ (ë°©ì—¼/ë¹„ë°©ì—¼ íƒ)","e6":0.44},
      {"display":"Libera","original":"20. ë¦¬ë² ë¼","e6":0.28},
      {"display":"Linen Zebra","original":"18. ë¦°ë„¨ ì§€ë¸Œë¼","e6":0.33},
      {"display":"Monaco","original":"17. ëª¨ë‚˜ì½”","e6":0.51},
      {"display":"Morning FR","original":"22. ëª¨ë‹ (ì¼ë¶€ë°©ì—¼)","e6":0.25},
      {"display":"Viar (Semi Blackout)","original":"7. ë¹„ì•„ë¥´ ì•”ë§‰ (ë°©ì—¼/ë¹„ë°©ì—¼ íƒ)","e6":0.46},
      {"display":"Bilbao (Semi Blackout)","original":"10. ë¹Œë°”ì˜¤ ì•”ë§‰","e6":0.67},
      {"display":"Cezanne (Blackout)","original":"9. ì„¸ì”(í¼í™íŠ¸)ì•”ë§‰","e6":0.6},
      {"display":"Adela F/R (Semi Blackout)","original":"6. ì•„ë¸ë¼ ì•”ë§‰ (ë°©ì—¼)","e6":0.43},
      {"display":"Andorra (Semi Blackout)","original":"13. ì•ˆë„ë¼ ì•”ë§‰","e6":0.42},
      {"display":"Olive","original":"15. ì˜¬ë¦¬ë¸Œ","e6":0.61},
      {"display":"â— ì¹´ë¼ë§Œ ì•”ë§‰","original":"14. ì¹´ë¼ë§Œ ì•”ë§‰","e6":0.42},
      {"display":"Krabi","original":"16. í¬ë¼ë¹„","e6":0.43},
      {"display":"Timberlook","original":"21. íŒ€ë²„ë£© (ì¼ë¶€ë°©ì—¼)","e6":0.45},
      {"display":"Phoenix (Semi Blackout)","original":"11. íœ˜ë‹‰ìŠ¤ ì•”ë§‰","e6":0.5}
    ],
    "ë¡¤": [
      {"display":"Marina Foam F.R (Blackout)","original":"34-1. ë§ˆë¦¬ë‚˜ í¼ ì•”ë§‰ (ë°©ì—¼)","e6":0.64},
      {"display":"Marina Foam (Blackout)","original":"34-2. ë§ˆë¦¬ë‚˜ í¼ ì•”ë§‰ (ë¹„ë°©ì—¼)","e6":0.64},
      {"display":"Radena F.R","original":"42 ë¼ë°ë‚˜ (ë°©ì—¼)","e6":0.35},
      {"display":"VGR B/O","original":"33. VGR ì•”ë§‰ (ë°©ì—¼)","e6":0.41},
      {"display":"Coral","original":"â— Coral ","e6":0.33},
      {"display":"Halong Bay","original":"â— Halong Bay","e6":0.44},
      {"display":"Polar night Blackout F.R","original":"â— Polar night","e6":0.6},
      {"display":"â— ê¸€ë¦¬í„°","original":"â— ê¸€ë¦¬í„°","e6":0.31},
      {"display":"Lenola Foam (Blackout)","original":"â— ë ˆë†€ë¼ í¼ ì•”ë§‰","e6":0.48},
      {"display":"â— ë ˆì¸","original":"â— ë ˆì¸","e6":0.34},
      {"display":"â— ë§ˆì¹¼ë£¨ í¼ ì•”ë§‰","original":"â— ë§ˆì¹¼ë£¨ í¼ ì•”ë§‰","e6":0.45},
      {"display":"â— ë©”ìŠ¤í‹°ì•„","original":"â— ë©”ìŠ¤í‹°ì•„","e6":0.35},
      {"display":"â— ë°€ë ˆ (í¼í™íŠ¸)ì•”ë§‰","original":"â— ë°€ë ˆ (í¼í™íŠ¸)ì•”ë§‰","e6":0.58},
      {"display":"â— ë¹„ë¹„ë“œ","original":"â— ë¹„ë¹„ë“œ","e6":0.38},
      {"display":"Sunscreen 4TW","original":"â— ì¬ìŠ¤í¬ë¦° 4TW","e6":0.75},
      {"display":"Sunflat F.R","original":"â— ì¬í”Œë › ë°©ì—¼","e6":0.38},
      {"display":"â— ì—ì½”ìŠ¤í¬ë¦° í¼ ì•”ë§‰","original":"â— ì—ì½”ìŠ¤í¬ë¦° í¼ ì•”ë§‰","e6":0.72},
      {"display":"â— ì—ì½”í”Œë«","original":"â— ì—ì½”í”Œë«","e6":0.38},
      {"display":"â— ì—˜ë°”ìŠ¤","original":"â— ì—˜ë°”ìŠ¤","e6":0.3},
      {"display":"Cherokee Foam (Blackout)","original":"â— ì²´ë¡œí‚¤ í¼ ì•”ë§‰","e6":0.61},
      {"display":"â— íƒ€íˆí‹°","original":"â— íƒ€íˆí‹°","e6":0.33},
      {"display":"â— íŠ¸ë ˆë¹„","original":"â— íŠ¸ë ˆë¹„","e6":0.47},
      {"display":"Granada","original":"47. ê·¸ë¼ë‚˜ë‹¤","e6":0.3},
      {"display":"Grend F.R","original":"41. ê·¸ë Œë“œ (ë°©ì—¼)","e6":0.48},
      {"display":"Nouvelle F.R (Blackout)","original":"35. ëˆ„ë²¨ ì•”ë§‰ (ë°©ì—¼)","e6":0.27},
      {"display":"Lamong","original":"48. ë¼ëª½","e6":0.35},
      {"display":"Sunscreen Rex 5%","original":"30. ë ‰ìŠ¤ (ë°©ì—¼)","e6":0.58},
      {"display":"Mild","original":"55. ë§ˆì¼ë“œ","e6":0.35},
      {"display":"Morea","original":"53. ëª¨ë ˆì•„","e6":0.46},
      {"display":"Sunscreen Lake (Blackout)","original":"32. ì†”íŠ¸ë ˆì´í¬ ì•”ë§‰ (ë°©ì—¼)","e6":0.35},
      {"display":"Sindy F.R","original":"43. ì‹ ë”” (ë°©ì—¼)","e6":0.37},
      {"display":"Sunscreen 3N 1%","original":"27. ì¬ìŠ¤í¬ë¦° 3N1% (ë°©ì—¼)","e6":0.68},
      {"display":"Sunscreen 3N 1% Metal","original":"25. ì¬ìŠ¤í¬ë¦° 3N1% ë©”íƒˆ (ë°©ì—¼)","e6":0.68},
      {"display":"Sunscreen 3N 3%","original":"28. ì¬ìŠ¤í¬ë¦° 3N3% (ë°©ì—¼)","e6":0.57},
      {"display":"Sunscreen 3N 3% Metal","original":"26. ì¬ìŠ¤í¬ë¦° 3N3% ë©”íƒˆ (ë°©ì—¼)","e6":0.57},
      {"display":"Sunscreen 4DP (1%)","original":"23. ì¬ìŠ¤í¬ë¦° 4DP (1%)(ë°©ì—¼)","e6":1.0},
      {"display":"Sunscreen 4N (3%)","original":"24. ì¬ìŠ¤í¬ë¦° 4N3% (ë°©ì—¼)","e6":0.77},
      {"display":"Sunhill","original":"54. ì¬í","e6":0.56},
      {"display":"Ariji","original":"50. ì•„ë¦¬ì§€","e6":0.73},
      {"display":"Ecoscreen F.R","original":"39. ì—ì½”ìŠ¤í¬ë¦° ë°©ì—¼","e6":0.53},
      {"display":"â— ì—‘ì…€ ì•”ë§‰ (ë°©ì—¼)","original":"36. ì—‘ì…€ ì•”ë§‰ (ë°©ì—¼)","e6":0.28},
      {"display":"Wellington Foam (Blackout)","original":"38. ì›°ë§í„´ í¼ ì•”ë§‰","e6":0.5},
      {"display":"â— ì œì´ë“œ","original":"51. ì œì´ë“œ","e6":0.78},
      {"display":"County","original":"49. ì¹´ìš´í‹°","e6":0.4},
      {"display":"â— ì¹´í”„ë¦¬ (ë°©ì—¼/ë¹„ë°©ì—¼ íƒ)","original":"40. ì¹´í”„ë¦¬ (ë°©ì—¼/ë¹„ë°©ì—¼ íƒ)","e6":0.5},
      {"display":"Cosca Foam (Blackout)","original":"37. ì½”ìŠ¤ì¹´ í¼ ì•”ë§‰","e6":0.5},
      {"display":"Torino F.R (Blackout)","original":"31. í† ë¦¬ë…¸ ì•”ë§‰ (ë°©ì—¼)","e6":0.72},
      {"display":"â— íŠ¸ë ˆë¹„","original":"52. íŠ¸ë ˆë¹„","e6":0.47},
      {"display":"Pastel F.R","original":"44. íŒŒìŠ¤í…” (ë°©ì—¼)","e6":0.35},
      {"display":"Sunscreen Haim 3%","original":"29. í•˜ì„ (ë°©ì—¼)","e6":0.86},
      {"display":"Hatchland","original":"45. í•´ì¹˜ëœë“œ","e6":0.4},
      {"display":"White Garden","original":"46. í™”ì´íŠ¸ê°€ë“ ","e6":0.35}
    ]
  },
    "tubes": [
      {"name":"ìœˆí•˜ìš°ìŠ¤(25Ã¸)","weight":0.228,"diameter":25},
      {"name":"ì½¤ë¹„/ë¡¤(30Ã¸)","weight":0.216,"diameter":30},
      {"name":"ì¼ë°˜ ì ë³´(38Ã¸)","weight":0.330,"diameter":38},
      {"name":"ìœˆí•˜ìš°ìŠ¤ ì ë³´(38Ã¸)","weight":0.306,"diameter":38},
      {"name":"38Ã¸íŠ¸ë¦¬í”Œ","weight":0.348,"diameter":38},
      {"name":"40Ã¸íŠ¸ë¦¬í”Œ","weight":0.410,"diameter":40},
      {"name":"ìœˆí•˜ìš°ìŠ¤ ì ë³´(45Ã¸)","weight":0.588,"diameter":45},
      {"name":"ì¤€ì‰ì´ë“œ(47Ã¸)","weight":0.773,"diameter":47},
      {"name":"ì†œí”¼(47Ã¸)","weight":0.469,"diameter":47},
      {"name":"ì¤€ì‰ì´ë“œ(57Ã¸)","weight":0.946,"diameter":57},
      {"name":"ì†œí”¼(57Ã¸)","weight":1.026,"diameter":57},
      {"name":"95mmì´ë…¸ì„¼ìŠ¤(57Ã¸)","weight":0.648,"diameter":57},
      {"name":"70Ã¸ì „ë™(70Ã¸)","weight":1.463,"diameter":70},
      {"name":"90Ã¸","weight":2.327,"diameter":90}
    ],
    "defaults": {"height":1000,"tube":"ì½¤ë¹„/ë¡¤(30Ã¸)","group":"ì´ë…¸ìœˆ","fabric_display":"â— ì´ë…¸ì„¼ìŠ¤ AT 75"},
    "limits": [
      {"name":"ì†Œì ì»¤ë²„","limit":60},
      {"name":"ì¤‘ì ì»¤ë²„","limit":75},
      {"name":"ëŒ€ì ì»¤ë²„","limit":90},
      {"name":"í”„ë¼ì„ ì»¤ë²„","limit":65},
      {"name":"ì‚¬ê° ì»¤ë²„","limit":65},
      {"name":"ì‚¬ê° ì»¤ë²„ (ì†Œ)","limit":60}
    ]
  }
  </script>

  <!-- Admin Modal -->
  <div id="adminModal" class="modal" aria-modal="true" role="dialog">
    <div class="panel">
      <div id="adminLogin">
        <h3>ê´€ë¦¬ì ë¡œê·¸ì¸</h3>
        <div style="display:flex;gap:8px;align-items:center">
          <label style="min-width:90px">ë¹„ë°€ë²ˆí˜¸</label><input id="adminPwd" type="password" placeholder="admin123" />
          <button class="btn primary" onclick="login()">ë¡œê·¸ì¸</button>
          <button class="btn" onclick="closeAdmin()">ë‹«ê¸°</button>
        </div>
        <div class="small muted" style="margin-top:8px">* ë¹„ë°€ë²ˆí˜¸ëŠ” ì´ ë¸Œë¼ìš°ì €ì˜ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì—ë§Œ ì €ì¥ë©ë‹ˆë‹¤.</div>
      </div>

      <div id="adminPanel" style="display:none">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:8px;margin-top:8px">
          <h3 style="margin:0">ë°ì´í„° í¸ì§‘</h3>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <button class="btn small" onclick="saveOverrides()">ë¸Œë¼ìš°ì € ì €ì¥</button>
            <button class="btn small" onclick="resetOverrides()">ë¸Œë¼ìš°ì € ì´ˆê¸°í™”</button>
            <button class="btn small" onclick="applyOverridesToRuntime()">í™”ë©´ ë°˜ì˜</button>
            <button class="btn small" onclick="closeAdmin()">ë‹«ê¸°</button>
          </div>
        </div>

        <details open class="card">
          <summary>ğŸ”§ íŠœë¸Œ ëª©ë¡ í¸ì§‘</summary>
          <div class="tg" id="tubeEditor">
            <div class="hdr">ì´ë¦„</div>
            <div class="hdr">ë¬´ê²Œ</div>
            <div class="hdr">ì§€ë¦„</div>
            <div class="hdr">ì‚­ì œ</div>
          </div>
          <button class="btn small" style="margin-top:8px" onclick="addTube()">íŠœë¸Œ ì¶”ê°€</button>
        </details>

        <details open class="card">
          <summary>ğŸ§µ ì›ë‹¨(ì¹´í…Œê³ ë¦¬ë³„) í¸ì§‘</summary>
          <div style="display:flex;gap:8px;align-items:center;margin-bottom:8px">
            <label style="min-width:80px">ì¹´í…Œê³ ë¦¬</label>
            <select id="catSelect"></select>
          </div>
          <div class="fg" id="fabricEditor">
            <div class="hdr">í‘œì‹œ ì´ë¦„</div>
            <div class="hdr">ì›ë³¸ í‚¤</div>
            <div class="hdr">ë‘ê»˜(e6)</div>
            <div class="hdr">ì‚­ì œ</div>
          </div>
          <button class="btn small" style="margin-top:8px" onclick="addFabric()">ì›ë‹¨ ì¶”ê°€</button>
        </details>

        <details open class="card">
          <summary>ğŸ“ ì»¤ë²„ë³„ ìµœëŒ€ ë‘ê»˜ í¸ì§‘</summary>
          <div class="lg" id="limitEditor">
            <div class="hdr">ì»¤ë²„ ì´ë¦„</div>
            <div class="hdr">ìµœëŒ€ ë‘ê»˜</div>
            <div class="hdr">ì‚­ì œ</div>
          </div>
          <button class="btn small" style="margin-top:8px" onclick="addLimit()">ì»¤ë²„ ì¶”ê°€</button>
        </details>

        <details class="card">
          <summary>ğŸ” Admin ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</summary>
          <div style="display:grid;gap:8px;max-width:520px">
            <input id="pwdCurrent" type="password" placeholder="í˜„ì¬ ë¹„ë°€ë²ˆí˜¸">
            <input id="pwdNew" type="password" placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸">
            <input id="pwdNew2" type="password" placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸">
            <div style="display:flex;gap:8px">
              <button class="btn small" onclick="changePassword()">ë³€ê²½</button>
              <button class="btn small" onclick="resetPassword()">ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”(admin123)</button>
            </div>
            <div class="small muted">* ë¹„ë°€ë²ˆí˜¸ëŠ” HTMLë¡œ ì €ì¥ë˜ì§€ ì•Šê³ , ì´ ë¸Œë¼ìš°ì €ì˜ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì—ë§Œ ì €ì¥ë©ë‹ˆë‹¤.</div>
          </div>
        </details>
      </div>
    </div>
  </div>

  <!-- ë¬¸ì„œ í•˜ë‹¨ ê´€ë¦¬ ë²„íŠ¼ -->
  <div class="card" style="margin-top:24px">
    <div style="display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end">
      <button class="btn small" onclick="exportJSON()">JSON ë‚´ë³´ë‚´ê¸°</button>
      <button class="btn small" onclick="importJSON()">JSON ê°€ì ¸ì˜¤ê¸°</button>
      <button class="btn small" onclick="saveIntoHTML()">HTMLë¡œ ì €ì¥</button>
      <button class="btn primary small" onclick="openAdmin()">Admin</button>
    </div>
  </div>

  <script>
    const STORE_KEY = "thickness_data_overrides";
    const PASS_KEY = "thickness_admin_pass";
    const DEFAULT_PASS = "admin123";
    const $ = (id)=>document.getElementById(id);

    function getEmbedded(){ 
      const el = document.getElementById("data-json");
      try { return JSON.parse(el.textContent); } catch (e) { alert("ë‚´ì¥ ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨"); return {}; }
    }
    const EMBED = getEmbedded();

    function mergedData(){
      const raw = localStorage.getItem(STORE_KEY);
      if(!raw) return JSON.parse(JSON.stringify(EMBED));
      try{ 
        const over = JSON.parse(raw);
        return {
          groups: over.groups || EMBED.groups,
          tubes: over.tubes || EMBED.tubes,
          defaults: over.defaults || EMBED.defaults,
          limits: over.limits || EMBED.limits,
        };
      }catch(e){ console.warn("Invalid overrides, using embed", e); return JSON.parse(JSON.stringify(EMBED)); }
    }

    let DATA = mergedData();

    function currentPass(){ return localStorage.getItem(PASS_KEY) || DEFAULT_PASS; }

    /* ---------- UI ì´ˆê¸°í™” ---------- */
    function init(){
      // íŠœë¸Œ ì„ íƒ
      const tSel = $("tube"); tSel.innerHTML="";
      DATA.tubes.forEach(t=>{
        const o=document.createElement("option");
        o.value=t.name; o.textContent=t.name;
        if(t.name===DATA.defaults.tube) o.selected=true;
        tSel.appendChild(o);
      });
      // ì¹´í…Œê³ ë¦¬ ë²„íŠ¼
      const cw = $("catwrap"); cw.innerHTML="";
      Object.keys(DATA.groups).forEach(cat=>{
        const b=document.createElement("button");
        b.className="catbtn"+(cat===DATA.defaults.group?" active":"");
        b.textContent=cat; b.dataset.cat=cat;
        b.onclick=()=>setCategory(cat);
        cw.appendChild(b);
      });
      // íŠœë¸Œ í‘œ
      const tBody = $("tubeTable"); tBody.innerHTML="";
      DATA.tubes.forEach(t=>{
        const tr=document.createElement("tr");
        tr.innerHTML=`<td>${t.name}</td><td>${t.weight}</td><td>${t.diameter}</td>`;
        tBody.appendChild(tr);
      });
      setCategory(DATA.defaults.group);
      renderLimitRows(0);

      // admin ì´ˆê¸° ìƒíƒœ
      $("adminModal").classList.remove("show"); 
      $("adminLogin").style.display = "";
      $("adminPanel").style.display = "none";
    }

    function setCategory(cat){
      document.querySelectorAll(".catbtn").forEach(el=>el.classList.toggle("active", el.dataset.cat===cat));
      const fSel = $("fabric"); fSel.innerHTML="";
      const items = DATA.groups[cat] || [];
      items.forEach((it,i)=>{
        const o=document.createElement("option");
        o.value=it.original; o.textContent=it.display;
        if(i===0 || it.display===DATA.defaults.fabric_display) o.selected=true;
        fSel.appendChild(o);
      });
      recalc();
    }

    function getTube(name){ return DATA.tubes.find(t=>t.name===name); }

    function renderLimitRows(g6){
      const tb = document.querySelector("#limitTable tbody"); tb.innerHTML="";
      DATA.limits.forEach(row=>{
        let cls="no", label="ë¶ˆê°€ëŠ¥";
        if(g6>0){
          if(g6<=row.limit-3){cls="ok";label="ê°€ëŠ¥";}
          else if(g6<=row.limit){cls="warn";label="ê°€ëŠ¥(ê°„ì„­ìœ„í—˜)";}
        }
        const tr=document.createElement("tr");
        tr.innerHTML=`<td>${row.name}</td><td><b>${row.limit}</b></td><td><span class="pill ${cls}">${label}</span></td>`;
        tb.appendChild(tr);
      });
    }

    function recalc(){
      let height = parseFloat($("height").value||0);
      const tube = getTube($("tube").value); const diameter = tube ? tube.diameter : 0;
      const activeCat = document.querySelector(".catbtn.active")?.dataset.cat;
      const mult = (activeCat==="ì½¤ë¹„"||activeCat==="íŠ¸ìœˆìŠ¤")?2:1;   // ì½¤ë¹„/íŠ¸ìœˆìŠ¤ 2ë°° ì ìš©
      const effH = height*mult;
      const items = DATA.groups[activeCat]||[];
      const sel = items.find(it=>it.original === $("fabric").value);
      const e6 = sel?sel.e6:undefined;
      let I=NaN,G=NaN;
      if((effH>=0)&&(diameter>0)&&(e6>0)){
        I=((-2*Math.PI*diameter)+Math.sqrt((2*Math.PI*diameter)**2+8*Math.PI*effH*e6))/(2*Math.PI*e6);
        G=diameter+2*I*e6;
      }
      $("g6").textContent = isFinite(G)?G.toFixed(1):"-";
      $("diameter").textContent = isFinite(diameter)?diameter:"-";
      $("e6").textContent = (e6!==undefined)?e6:"-";
      $("i6").textContent = isFinite(I)?I.toFixed(3):"-";
      renderLimitRows(isFinite(G)?G:0);
    }

    /* ---------- Admin ---------- */
    function openAdmin(){ $("adminModal").classList.add("show"); }
    function closeAdmin(){ $("adminModal").classList.remove("show"); $("adminLogin").style.display=""; $("adminPanel").style.display="none"; }
    function login(){ 
      const pwd = $("adminPwd").value.trim();
      if(pwd===currentPass()){ $("adminLogin").style.display="none"; $("adminPanel").style.display=""; mountEditors(); }
      else alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
    }

    function mountEditors(){ 
      // Tubes
      const host = $("tubeEditor");
      host.querySelectorAll(".row").forEach(n=>n.remove());
      DATA.tubes.forEach((t,idx)=> host.appendChild(tubeRow(idx,t)));
      // Fabrics
      const cs = $("catSelect"); cs.innerHTML="";
      Object.keys(DATA.groups).forEach(cat=>{ const o=document.createElement("option"); o.value=cat; o.textContent=cat; cs.appendChild(o); });
      cs.onchange = ()=> renderFabricEditor(cs.value);
      cs.value = Object.keys(DATA.groups)[0];
      renderFabricEditor(cs.value);
      // Limits
      renderLimitEditor();
    }

    function tubeRow(idx,t){ 
      const row = document.createElement("div"); row.className="row";
      row.innerHTML = `
        <input type="text" value="${t.name}" data-k="name">
        <input type="number" step="0.001" value="${t.weight}" data-k="weight">
        <input type="number" step="0.001" value="${t.diameter}" data-k="diameter">
        <button class="btn small delbtn" data-act="del">ì‚­ì œ</button>`;
      row.addEventListener("input",e=>{
        const k=e.target.getAttribute("data-k"); if(!k) return;
        DATA.tubes[idx][k]=(k==="name")?e.target.value:parseFloat(e.target.value||0);
      });
      row.querySelector('[data-act="del"]').onclick=()=>{
        DATA.tubes.splice(idx,1); mountEditors(); applyOverridesToRuntime();
      };
      return row;
    }

    function addTube(){ DATA.tubes.push({name:"ìƒˆ íŠœë¸Œ",weight:0,diameter:0}); mountEditors(); applyOverridesToRuntime(); }

    function renderFabricEditor(cat){ 
      const host = $("fabricEditor");
      host.querySelectorAll(".row").forEach(n=>n.remove());
      const arr = DATA.groups[cat]||[]; 
      arr.forEach((f,idx)=> host.appendChild(fabricRow(cat,idx,f)));
    }

    function fabricRow(cat,idx,f){ 
      const row=document.createElement("div"); row.className="row";
      row.innerHTML = `
        <input type="text" value="${f.display}" data-k="display">
        <input type="text" value="${f.original}" data-k="original">
        <input type="number" step="0.001" value="${f.e6}" data-k="e6">
        <button class="btn small delbtn" data-act="del">ì‚­ì œ</button>`;
      row.addEventListener("input",e=>{
        const k=e.target.getAttribute("data-k"); if(!k) return;
        DATA.groups[cat][idx][k]=(k==="e6")?parseFloat(e.target.value||0):e.target.value;
        applyOverridesToRuntime();
      });
      row.querySelector('[data-act="del"]').onclick=()=>{
        DATA.groups[cat].splice(idx,1); renderFabricEditor(cat); applyOverridesToRuntime();
      };
      return row;
    }

    function addFabric(){ const cat=$("catSelect").value; (DATA.groups[cat]=DATA.groups[cat]||[]).push({display:"ìƒˆ ì›ë‹¨",original:"ìƒˆ ì›ë³¸í‚¤",e6:0.0}); renderFabricEditor(cat); applyOverridesToRuntime(); }

    // Limits editor
    function renderLimitEditor(){
      const host=$("limitEditor");
      host.querySelectorAll(".row").forEach(n=>n.remove());
      DATA.limits.forEach((it,idx)=>{
        const row=document.createElement("div"); row.className="row";
        row.innerHTML=`
          <input type="text" value="${it.name}" data-k="name">
          <input type="number" step="0.001" value="${it.limit}" data-k="limit">
          <button class="btn small delbtn" data-act="del">ì‚­ì œ</button>`;
        row.addEventListener("input", e=>{
          const k=e.target.getAttribute("data-k"); if(!k) return;
          DATA.limits[idx][k]=(k==="limit")?parseFloat(e.target.value||0):e.target.value;
          applyOverridesToRuntime();
        });
        row.querySelector('[data-act="del"]').onclick=()=>{
          DATA.limits.splice(idx,1); renderLimitEditor(); applyOverridesToRuntime();
        };
        host.appendChild(row);
      });
    }
    function addLimit(){ DATA.limits.push({name:"ìƒˆ ì»¤ë²„", limit:0}); renderLimitEditor(); applyOverridesToRuntime(); }

    // Save/apply
    function saveOverrides(){ localStorage.setItem(STORE_KEY, JSON.stringify(DATA)); alert("ë¸Œë¼ìš°ì € ì €ì¥ ì™„ë£Œ"); }
    function resetOverrides(){ localStorage.removeItem(STORE_KEY); DATA = mergedData(); mountEditors(); applyOverridesToRuntime(); alert("ë¸Œë¼ìš°ì € ì €ì¥ ì´ˆê¸°í™”"); }
    function applyOverridesToRuntime(){ refreshRuntime(); }

    // Export/Import/Save HTML
    function exportJSON(){ const blob=new Blob([JSON.stringify(DATA,null,2)],{type:"application/json"}); const a=document.createElement("a"); a.href=URL.createObjectURL(blob); a.download="thickness_data.json"; a.click(); URL.revokeObjectURL(a.href); }
    function importJSON(){ const i=document.createElement("input"); i.type="file"; i.accept="application/json"; i.onchange=async()=>{ const f=i.files[0]; if(!f) return; const txt=await f.text(); try{ const obj=JSON.parse(txt); localStorage.setItem(STORE_KEY, JSON.stringify(obj)); DATA = mergedData(); alert("ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ."); refreshRuntime(); if(document.getElementById('adminPanel').style.display!=='none') mountEditors(); }catch(e){ alert("JSON íŒŒì‹± ì˜¤ë¥˜: "+e.message); } }; i.click(); }

    function saveIntoHTML(){
      try{
        const cloned = document.documentElement.cloneNode(true);
        // ì„ë² ë””ë“œ JSONë§Œ êµì²´ (ë¹„ë°€ë²ˆí˜¸ëŠ” ì €ì¥í•˜ì§€ ì•ŠìŒ)
        cloned.querySelector("#data-json").textContent = JSON.stringify(DATA);
        const html = "<!doctype html>\n" + cloned.outerHTML;
        const blob = new Blob([html], {type:"text/html"});
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = "thickness_gui_saved.html";
        a.click();
        URL.revokeObjectURL(a.href);
      }catch(e){
        alert("HTML ì €ì¥ ì¤‘ ì˜¤ë¥˜: " + e.message);
      }
    }

    // Password change
    function changePassword(){
      const cur=$("pwdCurrent").value, nv=$("pwdNew").value, nv2=$("pwdNew2").value;
      if(cur!==currentPass()){ alert("í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."); return; }
      if(!nv){ alert("ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."); return; }
      if(nv!==nv2){ alert("ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."); return; }
      localStorage.setItem(PASS_KEY, nv);
      $("pwdCurrent").value=$("pwdNew").value=$("pwdNew2").value="";
      alert("ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.");
    }
    function resetPassword(){ localStorage.removeItem(PASS_KEY); alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ê¸°ë³¸ê°’(admin123)ìœ¼ë¡œ ì´ˆê¸°í™”í–ˆìŠµë‹ˆë‹¤."); }

    // runtime refresh
    function refreshRuntime(){ 
      const tSel=$("tube"); tSel.innerHTML="";
      DATA.tubes.forEach(t=>{ const o=document.createElement("option"); o.value=t.name; o.textContent=t.name; if (t.name===DATA.defaults.tube) o.selected=true; tSel.appendChild(o); });
      const cw=$("catwrap"); cw.innerHTML="";
      Object.keys(DATA.groups).forEach(cat=>{ const b=document.createElement("button"); b.className="catbtn"+(cat===DATA.defaults.group?" active":""); b.textContent=cat; b.dataset.cat=cat; b.onclick=()=>setCategory(cat); cw.appendChild(b); });
      const tb=document.getElementById("tubeTable"); tb.innerHTML="";
      DATA.tubes.forEach(t=>{ const tr=document.createElement("tr"); tr.innerHTML=`<td>${t.name}</td><td>${t.weight}</td><td>${t.diameter}</td>`; tb.appendChild(tr); });
      setCategory(DATA.defaults.group); recalc();

      // Admin íŒ¨ë„ì„ ì—´ì–´ë‘” ìƒíƒœë¼ë©´ ëª©ë¡ë„ ë™ê¸°í™”
      if(document.getElementById('adminPanel').style.display!=='none'){ mountEditors(); }
    }

    function toggleDetails(){
      const wrap=document.getElementById("detailToggle");
      const el=document.getElementById("details");
      if(el.classList.contains("hidden")){el.classList.remove("hidden"); wrap.classList.remove("collapsed");}
      else {el.classList.add("hidden"); wrap.classList.add("collapsed");}
    }
    function toggleTubeList(){
      const card=document.getElementById("tubeCard");
      const list=document.getElementById("tubeList");
      if(list.classList.contains("hidden")){list.classList.remove("hidden"); card.classList.remove("collapsed");}
      else {list.classList.add("hidden"); card.classList.add("collapsed");}
    }

    document.addEventListener("keydown", (e)=>{ if(e.key==="Escape") closeAdmin(); });
    ["height","tube","fabric"].forEach(id=>{
      document.addEventListener("input",(e)=>{ if (e.target.id===id) recalc(); });
      document.addEventListener("change",(e)=>{ if (e.target.id===id) recalc(); });
    });

    init();
  </script>
</body>
</html>
